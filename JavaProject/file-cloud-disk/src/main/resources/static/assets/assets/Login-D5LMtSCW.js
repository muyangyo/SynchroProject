import{_ as k,u as S,a as C,r as _,c as R,b as g,d as t,w as a,f as u,h as E,j as f,e as y,R as v,U as q,k as F,E as p}from"./index-CJJi5dVY.js";const U={class:"login-container"},L={class:"login-box"},B={__name:"Login",setup(D){const b=S(),d=C(),i=_(null),s=_({username:"",password:""}),w={username:[{required:!0,type:"string",message:"请输入账号",trigger:"blur"}],password:[{required:!0,type:"string",message:"请输入密码",trigger:"blur"}]},x=()=>{i.value.validate(async c=>{var e,r;if(c){let l=await y(v.GET,"/user/getPublicKey","");d.setPublicKey(l.data);const n={username:d.encryptData(s.value.username),password:d.encryptData(s.value.password)};try{const o=await y(v.POST,"/user/login",n);o.statusCode==="SUCCESS"?(q.login(F.user,s.value.username,o.data),p({message:`欢迎回来, ${s.value.username}`,type:"success"}),await b.push("/user")):p.error(o.errMsg||"账号或密码错误")}catch(o){p.error(((r=(e=o.response)==null?void 0:e.data)==null?void 0:r.message)||"登录失败")}}})},V=()=>{i.value.resetFields()};return(c,e)=>{const r=u("el-input"),l=u("el-form-item"),n=u("el-button"),o=u("el-form");return E(),R("div",U,[g("div",L,[e[4]||(e[4]=g("div",{style:{"text-align":"center","margin-bottom":"20px","font-size":"36px","font-weight":"bold"}}," Login ",-1)),t(o,{model:s.value,rules:w,ref_key:"loginForm",ref:i,"label-width":"80px"},{default:a(()=>[t(l,{label:"账号",prop:"username"},{default:a(()=>[t(r,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=m=>s.value.username=m),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),t(l,{label:"密码",prop:"password"},{default:a(()=>[t(r,{type:"password",modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value.password=m),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(l,null,{default:a(()=>[t(n,{type:"primary",onClick:x},{default:a(()=>e[2]||(e[2]=[f("登录")])),_:1}),t(n,{onClick:V},{default:a(()=>e[3]||(e[3]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model"])])])}}},M=k(B,[["__scopeId","data-v-a82c2c4b"]]);export{M as default};

import{_ as R,r as _,o as C,c as k,b as f,a as t,w as a,e as g,f as E,U as S,R as U,h as d,i as u}from"./index-jlGd6iTg.js";import{e as v,R as y}from"./RequestTool-D0jUfVk2.js";import{r as p}from"./RSAEncryptUtils-Ybv_6rCu.js";const q={class:"login-container"},F={class:"login-box"},L={__name:"Login",setup(B){const w=E(),i=_(null),s=_({username:"",password:""}),b={username:[{required:!0,type:"string",message:"请输入账号",trigger:"blur"}],password:[{required:!0,type:"string",message:"请输入密码",trigger:"blur"}]},x=()=>{i.value.validate(async c=>{var e,r;if(c){let l=await v(y.GET,"/user/getPublicKey","");p.setPublicKey(l.data);const n={username:p.encryptData(s.value.username),password:p.encryptData(s.value.password)};try{const o=await v(y.POST,"/user/login",n);o.statusCode==="SUCCESS"&&o.data===!0?(S.login(U.user,s.value.username),d({message:`欢迎回来, ${s.value.username}`,type:"success"}),await w.push("/user")):d.error(o.errMsg||"账号或密码错误")}catch(o){d.error(((r=(e=o.response)==null?void 0:e.data)==null?void 0:r.message)||"登录失败")}}})},V=()=>{i.value.resetFields()};return(c,e)=>{const r=u("el-input"),l=u("el-form-item"),n=u("el-button"),o=u("el-form");return C(),k("div",q,[f("div",F,[e[4]||(e[4]=f("div",{style:{"text-align":"center","margin-bottom":"20px","font-size":"36px","font-weight":"bold"}}," Login ",-1)),t(o,{model:s.value,rules:b,ref_key:"loginForm",ref:i,"label-width":"80px"},{default:a(()=>[t(l,{label:"账号",prop:"username"},{default:a(()=>[t(r,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=m=>s.value.username=m),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),t(l,{label:"密码",prop:"password"},{default:a(()=>[t(r,{type:"password",modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value.password=m),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(l,null,{default:a(()=>[t(n,{type:"primary",onClick:x},{default:a(()=>e[2]||(e[2]=[g("登录")])),_:1}),t(n,{onClick:V},{default:a(()=>e[3]||(e[3]=[g("重置")])),_:1})]),_:1})]),_:1},8,["model"])])])}}},P=R(L,[["__scopeId","data-v-38d89eea"]]);export{P as default};

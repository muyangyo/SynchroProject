import{_ as R,r as _,o as C,c as k,b as f,a as t,w as r,e as g,f as E,U as S,R as U,h as p,i as u}from"./index-BktgtzP8.js";import{e as v,R as y}from"./RequestTool-BdeTmx98.js";import{r as d}from"./RSAEncryptUtils-Ybv_6rCu.js";const q={class:"login-container"},F={class:"login-box"},L={__name:"Login",setup(B){const b=E(),i=_(null),s=_({username:"",password:""}),w={username:[{required:!0,type:"string",message:"请输入账号",trigger:"blur"}],password:[{required:!0,type:"string",message:"请输入密码",trigger:"blur"}]},x=()=>{i.value.validate(async c=>{var e,a;if(c){let l=await v(y.GET,"/user/getPublicKey","");d.setPublicKey(l.data);const n={username:d.encryptData(s.value.username),password:d.encryptData(s.value.password)};try{const o=await v(y.POST,"/user/login",n);o.statusCode==="SUCCESS"&&o.data===!0?(S.login(U.user,s.value.username),p({message:`欢迎回来, ${s.value.username}`,type:"success"}),await b.push("/user")):p.error(o.errMsg||"账号或密码错误")}catch(o){p.error(((a=(e=o.response)==null?void 0:e.data)==null?void 0:a.message)||"登录失败")}}})},V=()=>{i.value.resetFields()};return(c,e)=>{const a=u("el-input"),l=u("el-form-item"),n=u("el-button"),o=u("el-form");return C(),k("div",q,[f("div",F,[e[4]||(e[4]=f("div",{style:{"text-align":"center","margin-bottom":"20px","font-size":"36px","font-weight":"bold"}}," Login ",-1)),t(o,{model:s.value,rules:w,ref_key:"loginForm",ref:i,"label-width":"80px"},{default:r(()=>[t(l,{label:"账号",prop:"username"},{default:r(()=>[t(a,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=m=>s.value.username=m),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),t(l,{label:"密码",prop:"password"},{default:r(()=>[t(a,{type:"password",modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value.password=m),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(l,null,{default:r(()=>[t(n,{type:"primary",onClick:x},{default:r(()=>e[2]||(e[2]=[g("登录")])),_:1}),t(n,{onClick:V},{default:r(()=>e[3]||(e[3]=[g("重置")])),_:1})]),_:1})]),_:1},8,["model"])])])}}},P=R(L,[["__scopeId","data-v-c3b048b2"]]);export{P as default};
